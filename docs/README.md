# RAN Simulator
See [deployment.md](deployment.md) for details of deploying and running the RAN simulator.

# Honeycomb Topology Generator

The RAN simulator comes with an accompanying utility that generates RAN topolog
YAML file, that is ready to be loaded by the RAN simulaotor.

This utility generates a hexagonal grid of RAN towers (E2 Nodes), each with a prescribed
number of cells with equal arc of coverage. The following is the command-line usage:

```
Usage:
  honeycomb topo outfile [flags]

Flags:
      --controller-addresses strings   List of E2T controller addresses or service names (default [onos-e2t])
  -e, --enbidstart uint32              EnbID start (default 5152)
  -h, --help                           help for topo
  -a, --latitude float                 Map centre latitude in degrees (default 52.52)
  -g, --longitude float                Map centre longitude in degrees (default 13.405)
  -d, --max-neighbor-distance float    Maximum distance between neighbor cells (default 3860)
      --max-neighbors int              Maximum number of neighbors a cell will have; -1 no limit (default 5)
  -i, --pitch float32                  pitch between cells in degrees (default 0.02)
      --plmnid string                  PlmnID in MCC-MNC format, e.g. CCCNNN or CCCNN (default "315010")
  -s, --sectors-per-tower uint         sectors per tower (default 3)
      --service-models strings         List of service models supported by the nodes (default [kpm/1,ni/2,rc/3])
  -t, --towers uint                    number of towers
```

Most options have reasonable defaults and only the `--towers` is mandatory.
Here is an example of how to run the command to generate topology for a network with
PLMNID of `314628` with 10 E2 nodes (towers), each with default number of 3 cells.

```
go run cmd/honeycomb/honeycomb.go topo  --plmnid 314628 --towers 10 pkg/utils/honeycomb/sample.yaml
```

Here is the [output generated by the above command](../pkg/utils/honeycomb/sample.yaml).

Note that for options that are lists, like `--cotnroller-addresses` for example, you can specify
them as comma-separated values `--controller-addresses onos-e2t-1,onos-e2t-2` or you can simply
repeat the option `--controller-addresses onos-e2t-1 --controller-addresses onos-e2t-2`.

# PCI Metrics Generator

Also available is a utility to support the PCI management use-case. It generates a
set of PCI metrics from the specified YAML file (possibly one generated by the Honeycomb
utility) in YAML format that can be loaded into the RAN simulator. The generated
metrics are cell size (ENTERPRISE, FEMTO, OUTDOOR_SMALL), EARFCN, PCI Pools and PCI itself.


```
Usage:
  metricsgen pci outfile [flags]

Flags:
      --cell-types strings    List of cell size types (default [ENTERPRISE,FEMTO,OUTDOOR_SMALL])
      --earfcn-start uint32   start point for EARFCN generation (default 42)
  -h, --help                  help for pci
      --max-collisions uint   maximum number of collisions (default 8)
      --max-pci uint          maximum PCI value (default 503)
      --min-pci uint          minimum PCI value
      --model string          path of the model.yaml file (default "model.yaml")
```

All options have reasonable defaults and only the `--model` is mandatory.
Here is an example of how to generate metrics for the above RAN topology where 8
PCI collisions are present, i.e. two neighboring towers share the same PCI and PCI pool.

```
go run cmd/metricsgen/metricsgen.go pci --model pkg/utils/honeycomb/sample.yaml pkg/servicemodel/rc/pciload/sample.yaml
```

Here is the [output generated by the above command](../pkg/servicemodel/rc/pciload/sample.yaml).

Note that the utility relies on random number generator and therefore its output is not deterministic.